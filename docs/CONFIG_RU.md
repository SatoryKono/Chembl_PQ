# Описание конфигурации

Инструменты обработки полностью управляются файлом `config.yaml`. Все
командные утилиты читают единые декларативные настройки, поэтому важно держать
конфигурацию в актуальном состоянии. Файл разбит на повторно используемые
разделы, перечисленные ниже.

## `source`

Параметры подключения, определяющие способ поиска входных данных.

| Ключ | Тип | Описание |
| --- | --- | --- |
| `kind` | `file` \| `http` \| `sharepoint` | Канал, через который разрешаются пути. |
| `base_path` | string | Корневая папка для файловых источников. |
| `http_base` | string | Базовый URL для HTTP-загрузок. |
| `sharepoint.site_url` | string | Сайт SharePoint, где размещены данные. |
| `sharepoint.library` | string | Необязательная библиотека документов SharePoint. |
| `sharepoint.auth` | `env` \| `device` \| `secrets` | Идентификатор сценария аутентификации. |

## `files`

Логические псевдонимы, сопоставленные с физическими файлами. Все загрузчики и
CLI обращаются к входам по ключам (например, `document_csv`). При `kind = file`
пути интерпретируются относительно `source.base_path`.

## `io`

Общие параметры форматирования для всех табличных чтений и записей.

| Ключ | Описание |
| --- | --- |
| `encoding_in` / `encoding_out` | Кодировки символов при импорте и экспорте. |
| `delimiter` | Разделитель полей в CSV-файлах. |
| `quoting` | Стратегия кавычек (`minimal`, `all` или `none`). |
| `na_values` | Маркеры, трактуемые как пропуски. |

## `options`

Исполнительные флаги, управляющие приведением типов и порядком столбцов.

| Ключ | Описание |
| --- | --- |
| `strict_types` | Принудительное соблюдение схем, объявленных модулями. |
| `preserve_order` | Детеминированный порядок столбцов между запусками. |
| `fail_on_schema_mismatch` | Ошибка при отсутствии обязательных столбцов. |
| `dateformat` | Канонический формат дат на выходе. |

## `cleaning`

Глобальные вспомогательные настройки. `alias_maps` и `drop_lists` указывают на
внешние CSV с нормализацией контролируемых словарей, а `sort_pipes` определяет,
нужно ли сортировать значения в полях с разделителем `|`.

## `pipeline`

Конфигурация по каждому публикуемому набору. Подразделы (`document`, `testitem`,
`assay`, `activity`, `target`) могут содержать следующие блоки:

* `classification_rules` — правила алиасов и фильтрации для полей с `|` перед
  агрегацией.
* `review` — веса и пороги, формирующие флаг экспертной проверки документов.
* `rename_map` — необязательная переименовка устаревших колонок.
* `invalid_rules` / `chirality_reference` — проверки качества, специфичные для
  тестовых образцов и активностей.
* `drop_columns` — список колонок, удаляемых перед публикацией.
* `type_map` — канонические типы pandas для каждой колонки выпуска.
* `column_order` — итоговый порядок столбцов при записи файлов.
* `output_columns` — явное описание схемы для внешних потребителей.

## `outputs`

Настройки каталога назначения и форматирования экспортируемых CSV.

| Ключ | Описание |
| --- | --- |
| `dir` | Папка по умолчанию для сформированных наборов данных. |
| `overwrite` | Разрешение перезаписывать существующие файлы при значении `true`. |
| `line_terminator` | Символ конца строки для CSV-записей. |
