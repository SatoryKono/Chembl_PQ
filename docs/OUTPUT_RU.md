# Публикуемые наборы данных

Каждая утилита постобработки возвращает типизированный `DataFrame` библиотеки
pandas. Имена столбцов, порядок и типы контролируются параметрами
`pipeline.*.type_map` и `pipeline.*.column_order` в `config.yaml`. Экспортируемые
CSV используют общие настройки раздела `outputs` (каталог, политика перезаписи и
символ перевода строки).

## Document

* Первичный ключ: `ChEMBL.document_chembl_id`.
* Агрегированные метрики: количества активностей, анализов и тестовых образцов
  (`n_activity`, `n_assay`, `n_testitem`).
* Маркеры качества: итоговое голосование (`review`) и флаг экспериментальной
  публикации (`is_experimental`).
* Текстовые поля приводятся к нижнему регистру, значения с разделителем `|`
  нормализуются общими хелперами очистки.

## Test item

* Первичный ключ: `molecule_chembl_id`.
* Производные флаги: `invalid_record` (правила качества) и `unknown_chirality`
  (булевый аналог логики Power Query).
* Структурные данные: `canonical_smiles` передается без изменений для внешнего
  сопоставления структур.
* Присоединения активностей используют подготовленный набор activity для
  согласованных подсчетов.

## Assay

* Первичный ключ: `assay_chembl_id`.
* Производная колонка `document_assay_total` считает количество анализов на
  документ.
* Шумовые колонки (таксономия, связи) удаляются на основании списка
  `drop_columns`.
* Агрегаты по активностям повторяют вычисления модуля документов.

## Target

* Первичный ключ: `target_chembl_id`.
* Синонимы нормализуются хелпером `clean_pipe` и дедуплицируются по идентификатору
  цели.
* Классификационные поля (`protein_class_pred_*`) приводятся к схеме из
  `type_map`.
* Экспорт строго соответствует `pipeline.target.output_columns`, что сохраняет
  стабильность интеграций.
